<!doctype html><html lang=en-US><head><meta charset=utf-8><meta content="ie=edge" http-equiv=x-ua-compatible><meta content="width=device-width,initial-scale=1,shrink-to-fit=no" name=viewport><link as=font href=https://xyquadrat.ch/fonts/vendor/jost/jost-v4-latin-regular.woff2 rel=preload type=font/woff2><link as=font href=https://xyquadrat.ch/fonts/vendor/jost/jost-v4-latin-700.woff2 rel=preload type=font/woff2><link href=https://xyquadrat.ch/main.css rel=stylesheet><meta content="index, follow" name=robots><meta content="index, follow, max-snippet:-1, max-image-preview:large, max-video-preview:-1" name=googlebot><meta content="index, follow, max-snippet:-1, max-image-preview:large, max-video-preview:-1" name=bingbot><title>Reading files in Zig for Advent of Code | xyquadrat.ch</title><meta content="Blog about software, ETH and life" name=description><link href=https://xyquadrat.ch/2021/12/01/reading-files-in-zig/ rel=canonical><script type=application/ld+json>
  {
    "@context": "http://schema.org",
    "@type": "BreadcrumbList",
    
      
      
        
        
        
        
        
        
        
        
          {
            "@type": "ListItem",
            "position":  1 ,
            "name": "Home",
            "item": "https://xyquadrat.ch/"
          },
          
          
          {
            "@type": "ListItem",
            "position":  2 ,
            "name": "2021",
            "item": "https://xyquadrat.ch/2021/"
          },
        
      
        
        
        
        
        
        
        
        
          
          
          {
            "@type": "ListItem",
            "position":  3 ,
            "name": "12",
            "item": "https://xyquadrat.ch/2021/12/"
          },
        
      
        
        
        
        
        
        
        
        
          
          
          {
            "@type": "ListItem",
            "position":  4 ,
            "name": "01",
            "item": "https://xyquadrat.ch/2021/12/01/"
          },
        
      
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
          
          
          {
            "@type": "ListItem",
            "position":  5 ,
            "name": "Reading Files In Zig",
            "item": "https://xyquadrat.ch/2021/12/01/reading-files-in-zig/"
          },
        
      
    
  }
</script><meta content=#fff name=theme-color><link href=https://xyquadrat.ch/apple-touch-icon.png rel=apple-touch-icon sizes=180x180><link href=https://xyquadrat.ch/favicon-32x32.png rel=icon sizes=32x32 type=image/png><link href=https://xyquadrat.ch/favicon-16x16.png rel=icon sizes=16x16 type=image/png><link href=https://xyquadrat.ch/site.webmanifest rel=manifest><body class="blog single"><div class="header-bar fixed-top"></div><header class="navbar fixed-top navbar-expand-md navbar-light"><div class=container><input class="menu-btn order-0" id=menu-btn type=checkbox><label class="menu-icon d-md-none" for=menu-btn><span class=navicon></span></label><a class="navbar-brand order-1 order-md-0 me-auto" href=https://xyquadrat.ch><img height=32px src=/mono_icon.svg></a><button aria-label="Toggle mode" class="btn btn-link order-2 order-md-4" id=mode type=button><span class=toggle-dark><svg class="feather feather-moon" viewbox="0 0 24 24" fill=none height=20 stroke=currentColor stroke-linecap=round stroke-linejoin=round stroke-width=2 width=20 xmlns=http://www.w3.org/2000/svg><path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"></path></svg></span> <span class=toggle-light><svg class="feather feather-sun" viewbox="0 0 24 24" fill=none height=20 stroke=currentColor stroke-linecap=round stroke-linejoin=round stroke-width=2 width=20 xmlns=http://www.w3.org/2000/svg><circle cx=12 cy=12 r=5></circle><line x1=12 x2=12 y1=1 y2=3></line><line x1=12 x2=12 y1=21 y2=23></line><line x1=4.22 x2=5.64 y1=4.22 y2=5.64></line><line x1=18.36 x2=19.78 y1=18.36 y2=19.78></line><line x1=1 x2=3 y1=12 y2=12></line><line x1=21 x2=23 y1=12 y2=12></line><line x1=4.22 x2=5.64 y1=19.78 y2=18.36></line><line x1=18.36 x2=19.78 y1=5.64 y2=4.22></line></svg></span></button><ul class="navbar-nav order-3 order-md-5"><li class=nav-item><a class=nav-link href=https://github.com/XYQuadrat><svg class="feather feather-github" viewbox="0 0 24 24" fill=none height=20 stroke=currentColor stroke-linecap=round stroke-linejoin=round stroke-width=2 width=20 xmlns=http://www.w3.org/2000/svg><path d="M9 19c-5 1.5-5-2.5-7-3m14 6v-3.87a3.37 3.37 0 0 0-.94-2.61c3.14-.35 6.44-1.54 6.44-7A5.44 5.44 0 0 0 20 4.77 5.07 5.07 0 0 0 19.91 1S18.73.65 16 2.48a13.38 13.38 0 0 0-7 0C6.27.65 5.09 1 5.09 1A5.07 5.07 0 0 0 5 4.77a5.44 5.44 0 0 0-1.5 3.78c0 5.42 3.3 6.61 6.44 7A3.37 3.37 0 0 0 9 18.13V22"></path></svg></a></ul><div class="collapse navbar-collapse order-4 order-md-1"><ul class="navbar-nav main-nav me-auto order-5 order-md-2"><li class=nav-item><a class=nav-link href=https://xyquadrat.ch/#blog>Blog</a><li class=nav-item><a class=nav-link href=https://xyquadrat.ch/and/>A&D</a></ul><div class="break order-6 d-md-none"></div></div></div></header><div class=container role=document><div class=content><div class="row justify-content-center"><div class="col-md-12 col-lg-10 col-xl-8"><article><div class=blog-header><h1>Reading files in Zig for Advent of Code</h1><p><small>01. December 2021  ‐ <strong>2 min read</strong></small><p></div><p><a href=https://ziglang.org rel=noopener target=_blank>Zig</a> is a lovely low-level language I’ve recently learned about, and what better way is there to learn a new language than to use it to solve <a href=https://adventofcode.com rel=noopener target=_blank>Advent of Code</a> problems. Alas, I set out on solving the technically very easy first task, managing to complete it in less than 15 minutes.<p>Or so I thought. Whilst I did have a rough idea of Zig’s syntax, and I had no problem writing loops or functions, I conveniently overlooked the issue of getting the input into my program. For reference, Day 1 had a list of integers as input; nothing difficult to parse per se. But my unfamiliarity with Zig led to serious problems when I tried to read said list of integers into an array.<p>I’ve tried various solutions, some of which seem deprecated whilst others should in theory work but I must have made mistakes whilst implementing them (I got lots of type mismatch errors), because it took me 45 minutes of trying before a helpful tip from a colleague that also decided to do AoC in Zig finally got me to a working snippet of code. (Once I had the input parsed, the two tasks were indeed easy and I managed to solve both of them within a few minutes.) To possibly spare someone else this frustrating process, the actual working code is as follows:<pre class=language-zig data-lang=zig style=background-color:#2b303b;color:#c0c5ce;><code class=language-zig data-lang=zig><span style=color:#b48ead;>const</span><span> std = </span><span style=color:#b48ead;>@import</span><span>(</span><span style=color:#a3be8c;>"std"</span><span>);
</span><span style=color:#b48ead;>const</span><span> data = </span><span style=color:#96b5b4;>@embedFile</span><span>(</span><span style=color:#a3be8c;>"/path/to/file"</span><span>);
</span><span>
</span><span style=color:#b48ead;>pub fn </span><span style=color:#8fa1b3;>main</span><span>() !</span><span style=color:#b48ead;>void </span><span>{
</span><span>    </span><span style=color:#b48ead;>var</span><span> lines = std.mem.</span><span style=color:#bf616a;>tokenize</span><span>(u8, data, </span><span style=color:#a3be8c;>"</span><span style=color:#96b5b4;>\n</span><span style=color:#a3be8c;>"</span><span>);
</span><span>
</span><span>    </span><span style=color:#b48ead;>while</span><span>(lines.</span><span style=color:#bf616a;>next</span><span>()) |line| {
</span><span>        </span><span style=color:#b48ead;>var </span><span style=color:#bf616a;>x </span><span>: </span><span style=color:#b48ead;>i64 </span><span>= </span><span style=color:#b48ead;>try</span><span> std.fmt.</span><span style=color:#bf616a;>parseInt</span><span>(i64, line, </span><span style=color:#d08770;>10</span><span>);
</span><span>        </span><span style=color:#65737e;>// do something with x, e.g. append to an ArrayList
</span><span>    }
</span><span>}
</span></code></pre><p>Remark: This solution embeds the contents of the file into the actual binary. This is not an issue at all for Advent of Code, but may very well not be the desired behavior for general file I/O.</article></div></div></div></div><footer class="footer text-muted"><div class=container><div class=row><div class=col-lg-8>Powered by <a href=https://www.getzola.org/>Zola</a></div><div class="col-lg-8 text-lg-end">Proudly part of the <a href=https://polyring.ch>Polyring blogging network</a></div></div></div></footer><script defer src=https://xyquadrat.ch/js/main.js></script>